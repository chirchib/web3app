# web3app тз
#### **Общее описание**

Приложение позволяет пользователям авторизоваться через Telegram и взаимодействовать с системой майнинга токенов в сети TON. Пользователи могут запускать майнинг, основанный на владении персональными смарт-контрактами. Система отслеживает активность пользователей, начисляет награды в виде токенов и хранит данные о транзакциях.

---

### **Типы пользователей**

**Пользователи:**

- Авторизуются через Telegram.
- Запускают пассивный майнинг токенов через персональный смарт-контракт.
- Видят текущий баланс токенов и историю транзакций.
- Могут передать контракт другому пользователю, приостанавливая свой майнинг.

---

### **Функциональные требования**

#### **Пользовательский интерфейс:**

**1. Регистрация/Авторизация:**

- Регистрация/Авторизация через Telegram.

**2. Главная страница:**

- Отображение данных пользователя (никнейм, аватарка).
- Текущий баланс токенов.
- Кнопка для запуска майнинга токенов.
- Статус майнинга (активен/неактивен).
- Начисленные токены за текущую сессию.

---

#### **Токен и майнинг:**

**Токен:**

- Тип: FT (Fungible Token) стандарта TON.
- Основные функции:
    - Выпуск токенов.
    - Переводы между пользователями.
    - Хранение балансов пользователей.

**Майнинг:**

- Для майнинга каждому пользователю создается **Mining Contract**.
- Майнинг активируется нажатием кнопки «Начать майнинг».
- Токены начисляются на пользовательский кошелек в зависимости от времени владения контрактом.

**Механика:**

1. Reward Distributor создает **Mining Contract** при активации майнинга.
2. Контракт отслеживает время владения пользователем.
3. Раз в заданный интервал времени Reward Distributor начисляет токены на кошелек пользователя.
4. При передаче контракта другому пользователю майнинг останавливается.

---

### **Архитектура и база данных**

#### **Архитектура:**

- Telegram Web App общается с бекендом через REST API.
- Бекенд обрабатывает запросы пользователей, взаимодействует с блокчейном через Web3 и управляет базой данных.
- Основные компоненты:
    - Token Contract: управление токенами.
    - Reward Distributor: создание Mining Contract и начисление токенов.
    - Mining Contract: учет времени владения и генерация запросов для наград.

---

#### **База данных:**

Используется реляционная база данных.

**Таблицы:**

1. **Пользователи:**
    
    - ID: Уникальный идентификатор.
    - Telegram ID: Идентификатор Telegram.
    - Адрес кошелька: Ссылка на кошелек TON.
    - Баланс токенов: Текущий баланс.
    - Статус: Активен/Заблокирован.
2. **Контракты майнинга:**
    
    - ID контракта: Уникальный идентификатор.
    - Адрес контракта: Смарт-контракт пользователя.
    - Пользователь ID: Внешний ключ на пользователя.
    - Дата создания: Дата и время активации контракта.
    - Последнее начисление: Время последнего расчета награды.
3. **Транзакции:**
    
    - ID транзакции: Уникальный идентификатор.
    - Пользователь ID: Внешний ключ на пользователя.
    - Тип транзакции: Начисление/Списание.
    - Сумма: Количество токенов.
    - Дата и время транзакции.

---

### **Сценарии работы**

#### **1. Регистрация и авторизация пользователя:**

- Пользователь авторизуется через Telegram.
- Приложение проверяет Telegram ID и создает учетную запись в базе данных (если она отсутствует).
- Пользователь привязывает TON-кошелек.

#### **2. Запуск майнинга:**

- Пользователь нажимает кнопку «Начать майнинг».
- Reward Distributor создает персональный Mining Contract.
- Контракт передается во владение пользователя, и майнинг становится активным.

#### **3. Начисление токенов:**

- Mining Contract раз в заданный интервал времени вызывает Reward Distributor.
- Reward Distributor начисляет токены пользователю в зависимости от времени владения контрактом.

#### **4. Передача контракта:**

- Пользователь может передать свой контракт другому кошельку.
- При передаче майнинг останавливается для старого владельца и возобновляется для нового.

#### **5. Просмотр истории транзакций:**

- Пользователь видит историю начислений и переводов токенов.

---

### **Возможные смарт-контракты**

|№|Название контракта|Описание|
|---|---|---|
|1|**Token Contract**|Управляет выпуском и переводами токенов (стандарт FT).|
|2|**Reward Distributor**|Центральный контракт для создания Mining Contract и начисления токенов.|
|3|**Mining Contract**|Генерируется для каждого пользователя. Управляет временем владения и запросами наград.|
|4|**User Wallet Contract**|Хранит баланс токенов пользователя.|

---
