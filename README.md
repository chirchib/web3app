#### **Общее описание**

Приложение позволяет пользователям авторизоваться через Telegram и взаимодействовать с системой майнинга токенов в сети TON. Пользователи могут запускать майнинг сертификатов через персональные контракты. Майнинг активируется после оплаты "майнера", а пользователи могут увеличивать производительность через дополнительные лицензии. Система позволяет интеграцию с различными методами оплаты: рубли, криптовалюта, банковские переводы.

---

### **Типы пользователей**

**Пользователи:**

- Авторизуются через Telegram.
- Покупают доступ к майнингу (активация "майнера").
- Увеличивают производительность своего майнера через покупку лицензий.
- Видят текущий баланс сертификатов и оставшееся время майнинга.
- Могут оплачивать услуги различными способами: фиат (рубли, доллары), криптовалюта.
- Просматривают историю начислений и оплаченных лицензий.

**Администраторы:**

- Управляют системой, сертификатами и оплатами.
- Решают спорные вопросы пользователей.
- Могут изменять данные или приостанавливать доступ пользователей.

---

### **Функциональные требования**

#### **Пользовательский интерфейс:**

**1. Регистрация/Авторизация:**

- Авторизация через Telegram.

**2. Главный экран:**

- Отображение данных пользователя:
    - Никнейм, аватарка.
    - Баланс сертификатов.
    - Прогресс фарминга (анимация).
    - Таймер обратного отсчета (оставшееся время фарминга).
- Кнопка "Фармить":
    - Активирует процесс начисления сертификатов.
    - Показывает скорость фарминга.
    - Анимация начисления сертификатов.

**3. Личный кабинет:**

- Общая информация:
    - Статус пользователя (активный/неактивный).
    - Данные по активированным лицензиям и их стоимости.
    - Информация о приобретенных сертификатах.
    - Ссылки на сайты компании, поддержку.
- Формирование счета:
    - Возможность сгенерировать счет для оплаты (для юридических лиц).
    - Получение ссылки на оплату (для физических лиц).
    - Генерация адреса криптокошелька для приема криптовалюты.

---

#### **Майнинг сертификатов:**

**Общая механика:**

- Выпуск общего объема сертификатов: **1 млрд**.
- Сразу выпускается 25% от общего объема для распределения между пользователями.
- Пользователи покупают право на майнинг через активацию "майнера".

**Майнинг:**

1. Пользователь оплачивает майнер:
    - Стоимость, эквивалентная желаемому количеству сертификатов (например, 10,000 руб за 10,000 сертификатов).
2. Запуск фарминга:
    - Пользователь нажимает кнопку "Фармить", что активирует процесс начисления.
    - Фарминг продолжается в течение 3 лет с момента активации.
3. Начисление сертификатов:
    - Пользователь получает токены пропорционально стоимости активированного майнера.
    - Скорость майнинга фиксируется исходя из суммы оплаты.
    - Сертификаты начисляются равномерно на протяжении всего времени.
4. Улучшение производительности:
    - Пользователь может докупить "лицензию" для увеличения скорости майнинга.
    - Лицензия пропорционально увеличивает начисление сертификатов.

---

#### **Оплаты и интеграции:**

1. **Методы оплаты:**
    
    - **Фиат:**
        - Оплата рублями, долларами через платежные шлюзы.
        - Счета для юридических лиц.
        - Линк для оплаты физическими лицами.
    - **Криптовалюта:**
        - Генерация криптокошелька для приема оплаты.
        - Система подтверждения транзакции.
2. **Принятие оплаты:**
    
    - После подтверждения оплаты пользователь активирует майнинг.
    - Акцепт условий оплаты встроен в систему.

---

### **Архитектура и база данных**

#### **Архитектура:**

- **Микросервисная архитектура:**
    
    - Telegram Web App взаимодействует с бекендом через REST API.
    - Бекенд управляет оплатами, фармингом и взаимодействием с блокчейном через Web3.
- **Смарт-контракты в TON:**
    
    - **Token Contract:** Управление выпуском и переводами сертификатов (FT).
    - **Reward Distributor:** Управляет начислением наград.
    - **Mining Contract:** Отслеживает прогресс майнинга и активирует начисления.

#### **База данных:**

**Таблицы:**

1. **Пользователи:**
    
    - ID: Уникальный идентификатор.
    - Telegram ID: Идентификатор Telegram.
    - Адрес кошелька: TON-адрес.
    - Баланс сертификатов.
    - Статус (активный/заблокирован).
2. **Майнеры:**
    
    - ID контракта: Уникальный идентификатор.
    - Пользователь ID: Внешний ключ на таблицу пользователей.
    - Время старта фарминга.
    - Таймер обратного отсчета (оставшееся время).
    - Текущая скорость майнинга.
    - Уровень лицензии.
3. **Лицензии:**
    
    - ID лицензии: Уникальный идентификатор.
    - Пользователь ID: Внешний ключ на пользователя.
    - Стоимость.
    - Увеличение скорости майнинга.
4. **Транзакции:**
    
    - ID транзакции: Уникальный идентификатор.
    - Тип транзакции: Покупка майнера/Лицензии.
    - Сумма: Оплаченная сумма.
    - Дата и время транзакции.

---

### **Сценарии работы**

#### **1. Регистрация и авторизация:**

- Пользователь авторизуется через Telegram.
- Система создает профиль в базе данных (если это новый пользователь).
- Пользователь добавляет TON-кошелек.

#### **2. Покупка майнера:**

- Пользователь выбирает желаемое количество сертификатов.
- Система генерирует счет для оплаты (для фиата) или адрес кошелька (для крипты).
- После подтверждения оплаты активируется "майнер".

#### **3. Запуск фарминга:**

- Пользователь нажимает кнопку "Фармить".
- Майнинг активируется, система запускает начисление токенов.
- Таймер обратного отсчета показывает оставшееся время фарминга.

#### **4. Улучшение производительности:**

- Пользователь приобретает лицензию.
- Скорость майнинга увеличивается пропорционально стоимости лицензии.

#### **5. Просмотр баланса и транзакций:**

- Пользователь может видеть текущий баланс сертификатов.
- Доступен раздел с историей операций (покупка майнера, лицензии).

---
### **Сценарии работы**

#### **1. Регистрация и авторизация**

1. Пользователь заходит в приложение через Telegram.
2. Система проверяет наличие пользователя в базе данных:
    - Если пользователь новый, создается профиль и предлагается подключить TON-кошелек.
    - Если пользователь уже зарегистрирован, он попадает на главный экран.

---

#### **2. Покупка майнера**

1. Пользователь переходит на страницу покупки майнера.
2. Выбирает сумму оплаты, соответствующую количеству сертификатов (например, 10,000 руб = 10,000 сертификатов).
3. Система предлагает варианты оплаты:
    - Генерация счета для юридических лиц.
    - Ссылка на оплату для физических лиц.
    - Генерация адреса TON-кошелька для оплаты криптовалютой.
4. Пользователь производит оплату.
5. После подтверждения оплаты система:
    - Активирует персональный майнер.
    - Возвращает пользователя на главный экран, где доступна кнопка "Фармить".

---

#### **3. Запуск фарминга**

1. Пользователь нажимает кнопку "Фармить".
2. Система:
    - Генерирует персональный смарт-контракт (Mining Contract).
    - Передает контракт в управление пользователя.
3. На главном экране отображается:
    - Таймер обратного отсчета времени майнинга (3 года).
    - Баланс сертификатов с визуализацией их начисления.
4. Система периодически обновляет баланс сертификатов на основе времени майнинга.

---

#### **4. Улучшение производительности майнера**

1. Пользователь открывает раздел улучшений.
2. Выбирает уровень лицензии, который увеличит скорость майнинга (например, x1.5 или x2).
3. Производит оплату через фиат или криптовалюту.
4. Система:
    - Модифицирует параметры его Mining Contract для увеличения скорости.
    - Отображает обновленные данные на главном экране (увеличение сертификатов в реальном времени).

---

#### **5. Окончание фарминга**

1. Таймер обратного отсчета достигает нуля (3 года с момента активации).
2. Система:
    - Перестает начислять сертификаты.
    - Отправляет уведомление пользователю о завершении майнинга.

---

#### **6. Переводы и вывод сертификатов**

1. Пользователь открывает раздел баланса.
2. Выбирает действие:
    - Перевести сертификаты на другой TON-кошелек.
    - Сформировать заявку на продажу сертификатов (при доступной интеграции).
3. Система обрабатывает запрос и завершает операцию.

---

#### **7. Управление данными пользователя**

1. Пользователь заходит в личный кабинет:
    - Видит свой профиль, активные майнеры, лицензии.
    - Может изменить настройки (например, привязать новый TON-кошелек).
2. Администратор (при необходимости):
    - Управляет профилем пользователя, например, решает спорные вопросы с оплатой.

---

#### **8. Просмотр истории операций**

1. Пользователь переходит в раздел транзакций.
2. Видит:
    - Историю всех операций: покупка майнера, лицензии, переводы сертификатов.
    - Даты и суммы каждой транзакции.

---
### **Дополнительные смарт-контракты**

|№|Название контракта|Описание|
|---|---|---|
|1|**Token Contract**|Управляет выпуском и переводами сертификатов (стандарт FT).|
|2|**Reward Distributor**|Распределяет награды по Mining Contract.|
|3|**Mining Contract**|Генерируется для пользователя, следит за прогрессом майнинга.|
|4|**Payment Contract**|Обрабатывает криптовалютные оплаты.|
